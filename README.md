# TRASSIR SDK Service

–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å TRASSIR SDK —á–µ—Ä–µ–∑ REST API –∏ WebSocket.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìπ –ü–æ–ª—É—á–µ–Ω–∏–µ FLV/MJPEG/RTSP –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–≤
- üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∫–∞–º–µ—Ä
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- üìù –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- üóÑÔ∏è –†–∞–±–æ—Ç–∞ —Å –∞—Ä—Ö–∏–≤–æ–º

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- FFmpeg (–¥–ª—è –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–≤)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ FFmpeg

**Windows:**
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ npm (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
npm install ffmpeg-static

# –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é
# –°–∫–∞—á–∞–π—Ç–µ —Å https://www.gyan.dev/ffmpeg/builds/
# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –≤ C:\ffmpeg\
# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –≤ server.js (—Å—Ç—Ä–æ–∫–∞ ~76): ffmpeg.setFfmpegPath('C:\\ffmpeg\\bin\\ffmpeg.exe');
```

**Linux/Ubuntu:**
```bash
sudo apt-get update
sudo apt-get install -y ffmpeg
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (Windows PowerShell)
$env:TRASSIR_HOST="192.168.109.181"
$env:TRASSIR_PORT="8080"
$env:TRASSIR_PASS="12345"
$env:TRASSIR_USER_LOGIN="prisma"
$env:TRASSIR_USER_PASSWORD="prisma"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (Windows CMD)
set TRASSIR_HOST=192.168.109.181
set TRASSIR_PORT=8080
set TRASSIR_PASS=12345
set TRASSIR_USER_LOGIN=prisma
set TRASSIR_USER_PASSWORD=prisma

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (Linux/Mac)
export TRASSIR_HOST=192.168.109.181
export TRASSIR_PORT=8080
export TRASSIR_PASS=12345
export TRASSIR_USER_LOGIN=prisma
export TRASSIR_USER_PASSWORD=prisma

# –ó–∞–ø—É—Å–∫
npm start
# –∏–ª–∏
node server.js
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `TRASSIR_HOST` | IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ TRASSIR | `192.168.109.181` |
| `TRASSIR_PORT` | –ü–æ—Ä—Ç SDK —Å–µ—Ä–≤–µ—Ä–∞ | `8080` |
| `TRASSIR_PASS` | –ü–∞—Ä–æ–ª—å SDK | `12345` |
| `TRASSIR_USER_LOGIN` | –õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è /get_video) | `prisma` |
| `TRASSIR_USER_PASSWORD` | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è /get_video) | `prisma` |
| `FFMPEG_PATH` | –ü—É—Ç—å –∫ FFmpeg (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |

## API Endpoints

- `GET /api/channels` - –°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤
- `GET /api/screenshot/:guid` - –°–∫—Ä–∏–Ω—à–æ—Ç –∫–∞–Ω–∞–ª–∞
- `GET /api/health` - –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- `GET /api/events` - –°–æ–±—ã—Ç–∏—è
- `GET /api/archive/:guid` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—Ä—Ö–∏–≤–µ

## WebSocket

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: `ws://localhost:8080`

–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∫–∞–º–µ—Ä.
–î–ª—è –∑–∞–ø—Ä–æ—Å–∞ –≤–∏–¥–µ–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ JSON: `{"guid": "GUID_–∫–∞–Ω–∞–ª–∞"}`

## –§–æ—Ä–º–∞—Ç—ã –≤–∏–¥–µ–æ

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤:
1. **FLV** (flash-—Ñ–æ—Ä–º–∞—Ç) - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
2. MJPEG
3. RTSP

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### FFmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ FFmpeg —á–µ—Ä–µ–∑ npm: `npm install ffmpeg-static` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Windows)
- –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é –∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `FFMPEG_PATH`
- –ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ `server.js` (—Å—Ç—Ä–æ–∫–∞ ~76): `ffmpeg.setFfmpegPath('C:\\ffmpeg\\bin\\ffmpeg.exe');`

### –û—à–∏–±–∫–∞ "no session"

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã `TRASSIR_USER_LOGIN` –∏ `TRASSIR_USER_PASSWORD`
- –≠—Ç–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ SDK –ø–∞—Ä–æ–ª—å)

### –ü–æ—Ç–æ–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 555 –æ—Ç–∫—Ä—ã—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ TRASSIR
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞–π–¥–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
node server.js
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

ISC

